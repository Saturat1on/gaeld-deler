<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>G√¶ld Tracker üí∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .section-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #333;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            width: 100%;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .person-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #667eea;
        }
        
        .person-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .person-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }
        
        .person-debt {
            font-size: 1.5em;
            font-weight: bold;
            color: #e74c3c;
        }
        
        .person-debt.paid {
            color: #27ae60;
        }
        
        .action-row {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .btn-small {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-size: 0.9em;
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-add {
            background: #e74c3c;
            color: white;
        }
        
        .btn-subtract {
            background: #27ae60;
            color: white;
        }
        
        .btn-sms {
            background: #3498db;
            color: white;
        }
        
        .btn-delete {
            background: #95a5a6;
            color: white;
        }
        
        .amount-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 10px;
        }
        
        .empty-state {
            text-align: center;
            color: #999;
            padding: 30px;
            font-size: 1.1em;
        }
        
        .transaction-list {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
            font-size: 0.9em;
            color: #666;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ G√¶ld Tracker</h1>
            <p>Hold styr p√• hvem der skylder hvad</p>
        </div>

        <!-- Tilf√∏j person -->
        <div class="card">
            <div class="section-title">‚ûï Tilf√∏j Person</div>
            <input type="text" id="newPersonName" placeholder="Navn..." style="width: 100%; margin-bottom: 10px;" />
            <input type="tel" id="newPersonPhone" placeholder="Tlf (valgfrit)" style="width: 100%; margin-bottom: 15px;" />
            <button class="btn" onclick="addPerson()">Tilf√∏j</button>
        </div>

        <!-- Personer med g√¶ld -->
        <div class="card">
            <div class="section-title">üë• G√¶ld Oversigt</div>
            <div id="personList"></div>
        </div>
    </div>

    <!-- Modal til tilf√∏j/fratr√¶k -->
    <div class="modal" id="amountModal">
        <div class="modal-content">
            <div class="section-title" id="modalTitle"></div>
            <input type="number" class="amount-input" id="modalAmount" placeholder="Bel√∏b (kr)" step="0.01" />
            <input type="text" class="amount-input" id="modalNote" placeholder="Note (valgfrit)" />
            <div class="modal-buttons">
                <button class="btn" onclick="closeModal()" style="background: #95a5a6;">Annuller</button>
                <button class="btn" onclick="confirmAmount()" id="confirmBtn">Bekr√¶ft</button>
            </div>
        </div>
    </div>

    <script>
        let people = [];
        let currentPerson = null;
        let currentAction = null;

        // Load data
        function loadData() {
            const saved = localStorage.getItem('debtTracker');
            if (saved) people = JSON.parse(saved);
            updateUI();
        }

        // Gem data
        function saveData() {
            localStorage.setItem('debtTracker', JSON.stringify(people));
        }

        // Tilf√∏j person
        function addPerson() {
            const name = document.getElementById('newPersonName').value.trim();
            const phone = document.getElementById('newPersonPhone').value.trim();
            
            if (name) {
                people.push({
                    name: name,
                    phone: phone,
                    debt: 0,
                    transactions: []
                });
                document.getElementById('newPersonName').value = '';
                document.getElementById('newPersonPhone').value = '';
                saveData();
                updateUI();
            }
        }

        // Vis modal
        function showModal(index, action) {
            currentPerson = index;
            currentAction = action;
            
            const modal = document.getElementById('amountModal');
            const title = document.getElementById('modalTitle');
            const confirmBtn = document.getElementById('confirmBtn');
            
            if (action === 'add') {
                title.textContent = '‚ûï Tilf√∏j G√¶ld';
                confirmBtn.textContent = 'Tilf√∏j G√¶ld';
                confirmBtn.style.background = '#e74c3c';
            } else {
                title.textContent = 'üí≥ Registrer Betaling';
                confirmBtn.textContent = 'Registrer';
                confirmBtn.style.background = '#27ae60';
            }
            
            modal.style.display = 'block';
            document.getElementById('modalAmount').focus();
        }

        // Luk modal
        function closeModal() {
            document.getElementById('amountModal').style.display = 'none';
            document.getElementById('modalAmount').value = '';
            document.getElementById('modalNote').value = '';
        }

        // Bekr√¶ft bel√∏b
        function confirmAmount() {
            const amount = parseFloat(document.getElementById('modalAmount').value);
            const note = document.getElementById('modalNote').value.trim();
            
            if (amount > 0) {
                const person = people[currentPerson];
                const date = new Date().toLocaleDateString('da-DK');
                
                if (currentAction === 'add') {
                    person.debt += amount;
                    person.transactions.push({
                        type: 'add',
                        amount: amount,
                        note: note || 'G√¶ld tilf√∏jet',
                        date: date
                    });
                } else {
                    person.debt -= amount;
                    person.transactions.push({
                        type: 'subtract',
                        amount: amount,
                        note: note || 'Betaling modtaget',
                        date: date
                    });
                }
                
                saveData();
                updateUI();
                closeModal();
            }
        }

        // Send SMS
        function sendSMS(index) {
            const person = people[index];
            const message = `Hej ${person.name}! Du skylder mig ${person.debt.toFixed(2)} kr. Kan du betale via MobilePay eller bankoverf√∏rsel? Mvh`;
            
            if (person.phone) {
                window.location.href = `sms:${person.phone}?body=${encodeURIComponent(message)}`;
            } else {
                alert('Intet telefonnummer gemt for denne person');
            }
        }

        // Slet person
        function deletePerson(index) {
            if (confirm(`Slet ${people[index].name}?`)) {
                people.splice(index, 1);
                saveData();
                updateUI();
            }
        }

        // Opdater UI
        function updateUI() {
            const list = document.getElementById('personList');
            
            if (people.length === 0) {
                list.innerHTML = '<div class="empty-state">Ingen personer endnu<br>Tilf√∏j en person for at starte</div>';
                return;
            }
            
            list.innerHTML = people.map((person, index) => `
                <div class="person-card">
                    <div class="person-header">
                        <div class="person-name">üë§ ${person.name}</div>
                        <div class="person-debt ${person.debt <= 0 ? 'paid' : ''}">
                            ${person.debt > 0 ? person.debt.toFixed(2) : '0.00'} kr
                        </div>
                    </div>
                    
                    <div class="action-row">
                        <button class="btn-small btn-add" onclick="showModal(${index}, 'add')">‚ûï Tilf√∏j G√¶ld</button>
                        <button class="btn-small btn-subtract" onclick="showModal(${index}, 'subtract')">üí≥ Betaling</button>
                    </div>
                    
                    <div class="action-row">
                        <button class="btn-small btn-sms" onclick="sendSMS(${index})">üì± Send SMS</button>
                        <button class="btn-small btn-delete" onclick="deletePerson(${index})">üóëÔ∏è Slet</button>
                    </div>
                    
                    ${person.transactions.length > 0 ? `
                        <div class="transaction-list">
                            <strong>Historik:</strong>
                            ${person.transactions.slice(-3).reverse().map(t => `
                                <div class="transaction-item">
                                    <span>${t.date} - ${t.note}</span>
                                    <span style="color: ${t.type === 'add' ? '#e74c3c' : '#27ae60'}">
                                        ${t.type === 'add' ? '+' : '-'}${t.amount.toFixed(2)} kr
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Enter key support
        document.getElementById('newPersonName').addEventListener('keypress', e => {
            if (e.key === 'Enter') {
                document.getElementById('newPersonPhone').focus();
            }
        });
        
        document.getElementById('newPersonPhone').addEventListener('keypress', e => {
            if (e.key === 'Enter') addPerson();
        });
        
        document.getElementById('modalAmount').addEventListener('keypress', e => {
            if (e.key === 'Enter') confirmAmount();
        });

        // Luk modal ved klik udenfor
        document.getElementById('amountModal').addEventListener('click', e => {
            if (e.target.id === 'amountModal') closeModal();
        });

        // Load data ved start
        loadData();
    </script>
</body>
</html>
